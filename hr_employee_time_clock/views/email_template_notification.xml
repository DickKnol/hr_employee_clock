<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data noupdate="0">
        <record id="email_template_last_day_notification" model="mail.template">
            <field name="name">Attandance Sheet Last Day - Send by Email</field>
            <field name="email_from">${(object.create_uid.email and '%s &lt;%s&gt;' % (object.create_uid.name, object.create_uid.email) or '')|safe}</field>
            <field name="subject">Attandance Sheet Last Day Notification</field>
            <field name="partner_to">${object.employee_id.user_id.partner_id.id}</field>
            <field name="model_id" ref="hr_employee_time_clock.model_hr_timesheet_sheet_sheet"/>
            <field name="auto_delete" eval="False"/>
            <field name="lang">${object.employee_id.user_id.partner_id.lang}</field>
            <field name="body_html"><![CDATA[

            <style>
                table {
                    border-collapse: collapse;
                    padding-bottom: 40px;
                }
                td {
                    color: black;
                    line-height: 40px;
                    font-size: 16px;
                    border-bottom: 1px
                }
                tr {

                    border-bottom: 1px solid #f0f5f5;
                }
                h2 {
                    width: 90%;
                    font-size: 18px;
                    color: #000000;
                    text-align: center;
                }
                h3 {
                   font-size: 16px;
                   color: #005580;
                   text-align: left;
                }
                button {
                    margin: 20px 0;
                    padding: 10px 15px;
                    text-align: center;
                    font-size: 15px;
                    background-color: #f0f5f5;
                    border: 2px solid #e6f2ff;
                    border-radius: 5px;
                }
                a:link {
                }
                button:hover {
                    background-color: #ccf2ff;
                    cursor: pointer;
                }
            </style>

            <div style="width: 100%; background-color: #f0f5f5; padding: 50px 0;">

                <center>
                <div style="width: 550px;">
                    <div style="padding: 10px 15px; background-color: white;">
                        <h2 style="color: #005580;"><b>${object.employee_id.name}, current period is closing soon.</b></h2>
                        <h2>You still have <span style="color: #ff751a;">${"%.2f" % object.total_duty_hours}</span> hours to log.
                        <br/>Please, be sure to complete your attendance sheet soon!</h2>
                    </div>

                    <div style="margin-top: 10px; padding: 15px; background-color: white;">
                        <h3>Your attendance sheet status</h3>
                        <table style="width: 100%;">
                            <tbody>
                                <tr>
                                    <td>Period</td>
                                    <td style="text-align: right"><b>${object.date_from} - ${object.date_to}</b></td>
                                </tr>
                                <tr>
                                    <td>Total hours required</td>
                                    <td style="text-align: right"><b>${"%.2f" % (object.total_attendance + object.total_duty_hours)}</b></td>
                                </tr>
                                <tr>
                                    <td>Logged hours</td>
                                    <td style="text-align: right"><b>${"%.2f" % object.total_attendance}</b></td>
                                </tr>
                                <tr>
                                    <td>Total balance</td>
                                    <td style="text-align: right; color: #ff751a;"><b>${"%.2f" % object.calculate_diff_hours}</b></td>
                                </tr>
                            </tbody>
                        </table>
                        <center>
                            <a href="/web?#id=${object.id}&view_type=form&model=hr_timesheet_sheet.sheet">
                                <button>View Attendance Sheet</button></a>
                        </center>
                    </div>
                </div>
                </center>
            </div>

        ]]></field>
        </record>

    </data>
</odoo>
